import { ImageResponse } from "@vercel/og";
import dayjs from "dayjs";
import utc from "dayjs/plugin/utc";
import timezone from "dayjs/plugin/timezone";

dayjs.extend(utc);
dayjs.extend(timezone);

const cetAdjustment = dayjs().tz("Europe/Berlin").utcOffset();

export const config = {
  runtime: "experimental-edge",
};

async function handle(request: Request) {
  const BASE_URL = process.env.VERCEL_URL
    ? `https://${process.env.VERCEL_URL}`
    : "http://localhost:3000";

  const stickers = Array.from(
    { length: 20 },
    (_, i) => `${BASE_URL}/images/stickers/Stickers-${i}.svg`
  );

  const getRandomSticker = () => {
    const randomIndex = Math.floor(Math.random() * stickers.length);
    return stickers[randomIndex];
  };

  const getRandomPosition = () => {
    const topOrBottom = Math.random() < 0.5 ? "top" : "bottom";
    const rotation = Math.floor(Math.random() * (20 - -20 + 1)) + -20;
    let left;

    if (topOrBottom === "bottom") {
      // Ensure the sticker is not placed in the middle of the artwork
      const side = Math.random() < 0.5 ? "left" : "right";
      if (side === "left") {
        left = Math.floor(Math.random() * 309);
      } else {
        left = Math.floor(Math.random() * 309) + (1080 - 309);
      }
    } else {
      left = Math.floor(Math.random() * (900 - 100 + 1)) + 100;
    }

    return { left, topOrBottom, rotation };
  };

  const randomSticker = getRandomSticker();
  const randomPosition = getRandomPosition();

  const response = await fetch(`${BASE_URL}/api/schedule`);
  const schedule = await response.json();

  let todaysSchedule = [];

  schedule.schedule.forEach((show) => {
    const date = dayjs(show.date);
    const adjustedDate = date.subtract(5, "hour");
    if (adjustedDate.isSame(dayjs(), "day")) {
      todaysSchedule.push(show);
    }
  });

  const longSchedule = todaysSchedule.length > 10;

  const fontLight = await fetch(
    new URL("../../assets/VisueltLight.otf", import.meta.url)
  ).then((res) => res.arrayBuffer());

  const fontMedium = await fetch(
    new URL("../../assets/VisueltMedium.otf", import.meta.url)
  ).then((res) => res.arrayBuffer());

  const fontArizona = await fetch(
    new URL("../../assets/ABCArizonaFlare.otf", import.meta.url)
  ).then((res) => res.arrayBuffer());

  const randomWidth = Math.floor(Math.random() * (600 - 285 + 1)) + 285;

  let responsiveFontSize = 40;
  if (longSchedule) {
    responsiveFontSize = 38;
  }

  return new ImageResponse(
    (
      <div tw="flex flex-col w-full h-full px-[60px] pb-[20px] text-white bg-opacity-0 pt-[170px] bg-black/25">
        <div tw="flex">
          <div tw="flex flex-col grow py-2">
            <div
              tw="text-[120px] font-bold flex -mb-4"
              style={{
                fontFamily: '"fontArizona"',
                lineHeight: "90%",
                letterSpacing: "-0.02em",
              }}
            >
              Today on the radio
            </div>
            <div
              tw="text-[125px] font-bold flex"
              style={{
                fontFamily: '"fontArizona"',
                lineHeight: "90%",
                letterSpacing: "-0.02em",
              }}
            >
              {dayjs().format("D MMMM")}
            </div>
          </div>
          <div tw="flex absolute left-[727px] top-[75px] w-[206px] ">
            <svg
              width="213"
              height="172"
              viewBox="0 0 213 172"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <rect
                x="38.0784"
                y="0.501726"
                width="183.666"
                height="119.028"
                transform="rotate(18.4027 38.0784 0.501726)"
                fill="#D9D9D9"
              />
              <rect
                x="38.0784"
                y="0.501726"
                width="183.666"
                height="119.028"
                transform="rotate(18.4027 38.0784 0.501726)"
                stroke="#0A0A0A"
                stroke-width="0.793521"
              />
              <path
                d="M78.5572 68.9175C80.3993 69.5304 81.8337 73.5157 80.5982 77.2292C79.8744 79.4048 78.8348 80.9554 77.1247 82.093C75.4337 78.5923 74.7842 74.395 75.9628 70.8525C76.4885 69.2725 77.4442 68.5472 78.5572 68.9175ZM75.612 90.9288C79.5958 92.2543 82.9779 91.673 85.6869 89.5395L85.6587 89.4835C85.2431 89.4403 84.8014 89.3399 84.3721 89.1971C81.5028 88.2425 78.9433 85.6378 77.2953 82.4347C83.0766 82.2251 86.8542 80.0223 88.0328 76.4798C89.0696 73.3633 87.0654 70.0902 83.0378 68.7501C76.183 66.4695 70.2671 70.2374 68.1944 76.467C65.9934 83.0824 69.5705 88.9188 75.612 90.9288Z"
                fill="#0A0A0A"
              />
              <path
                d="M152.335 140.794C150.944 139.801 149.528 138.842 148.087 137.923C153.045 134.864 157.663 130.584 161.567 125.456C164.387 126.959 167.165 128.532 169.901 130.168C164.882 134.957 158.869 138.578 152.335 140.794ZM50.1617 65.4443L55.2027 50.2931L56.5733 50.7491C59.9156 51.8611 60.6353 55.1335 59.2011 59.4442C57.4404 64.7362 55.5313 66.8992 50.1617 65.4443ZM33.4304 97.0031C21.6997 73.6869 31.1619 45.2468 54.5231 33.606C66.2036 27.7856 79.1816 27.2493 90.7055 31.0833C101.218 34.5811 110.521 41.7182 116.525 51.7966C104.687 57.2295 95.0479 67.3357 90.6304 80.6133C87.4956 90.0352 87.4244 99.7522 89.869 108.689C89.4521 108.861 89.0347 109.028 88.6177 109.194C88.0908 109.394 87.5529 109.561 87.0211 109.748C85.9465 110.078 84.8573 110.367 83.7572 110.596C81.5564 111.056 79.3137 111.306 77.0723 111.331C74.8308 111.356 72.5917 111.174 70.3905 110.791C68.1915 110.397 66.0289 109.822 63.9361 109.054L63.1525 108.765C62.8933 108.663 62.6394 108.55 62.3823 108.441L61.6142 108.115C61.3587 108.002 61.1113 107.874 60.8596 107.755L60.105 107.4C59.8538 107.279 59.6118 107.141 59.3644 107.014L58.6275 106.621C58.3811 106.491 58.1472 106.34 57.9057 106.2C57.4275 105.917 56.9467 105.637 56.4885 105.322C56.0232 105.016 55.558 104.711 55.1127 104.378C54.6615 104.052 54.2016 103.736 53.773 103.38C53.3406 103.03 52.8958 102.696 52.485 102.319C49.1131 99.4137 46.2665 95.8764 44.1973 91.9112C42.0576 87.9799 40.7385 83.6046 40.2661 79.1399C40.2486 78.9871 40.2402 78.8337 40.2243 78.6814L48.8482 81.5507L49.0759 80.8664L45.4338 79.6547L49.8922 66.2545L53.3894 83.0616L65.6002 87.1242L65.8279 86.4399L63.7703 85.7554L59.4306 68.3381C64.2839 68.6246 67.6773 66.8622 69.0831 62.6371C70.7869 57.5162 66.7836 53.3879 58.3428 50.5795L42.1918 45.206L45.2372 48.779L36.008 76.5186L32.5814 75.3786L32.3538 76.0629L39.4596 78.427C39.4719 78.6875 39.4772 78.9473 39.4966 79.2083C39.8461 83.7881 41.1152 88.2919 43.101 92.4642C45.1418 96.6118 47.9852 100.386 51.4518 103.488C51.8745 103.889 52.3334 104.246 52.7815 104.619C53.2225 104.997 53.6965 105.336 54.1618 105.684C54.6217 106.043 55.1155 106.355 55.5986 106.677C56.0795 107.005 56.5825 107.3 57.0834 107.595C57.3357 107.74 57.5815 107.899 57.8387 108.035L58.6096 108.444C58.8694 108.577 59.1217 108.722 59.3842 108.847L60.1745 109.219C60.4403 109.34 60.7006 109.466 60.9685 109.58L61.7792 109.907C62.0498 110.013 62.3177 110.128 62.5899 110.229L63.4135 110.517C65.6099 111.282 67.8799 111.836 70.1802 112.148C72.4779 112.468 74.8043 112.566 77.113 112.436C79.4212 112.308 81.7123 111.972 83.9486 111.421C85.0664 111.15 86.168 110.814 87.2544 110.442C87.7938 110.243 88.3391 110.064 88.8725 109.851L90.0559 109.361C91.0717 112.879 92.4793 116.269 94.2454 119.468C71.4533 129.031 44.6925 119.385 33.4304 97.0031ZM183.128 85.1952C180.146 85.0062 177.171 84.7354 174.209 84.379C173.895 78.8878 172.776 73.7368 170.952 69.1486C172.662 69.2782 174.375 69.3589 176.09 69.397C179.374 74.1824 181.767 79.5425 183.128 85.1952ZM164.903 120.582C168.394 121.448 171.389 120.792 173.832 118.868L173.804 118.81C173.39 118.767 172.948 118.668 172.519 118.526C169.65 117.571 167.09 114.965 165.443 111.762C171.222 111.551 175.001 109.349 176.18 105.807C177.025 103.266 175.848 100.623 173.202 99.0064C173.246 98.7842 173.292 98.5631 173.332 98.3415C174.147 93.8033 174.431 89.3606 174.243 85.1092C177.251 85.4683 180.27 85.7412 183.299 85.9297C185.108 93.9976 184.821 102.632 182.029 111.022C179.607 118.303 175.567 124.598 170.437 129.65C167.671 127.991 164.86 126.396 162.007 124.875C163.025 123.5 163.993 122.067 164.903 120.582ZM150.736 119.327C152.543 116.01 154.229 112.414 155.743 108.594C155.224 114.01 158.588 118.535 163.759 120.256C163.899 120.302 164.037 120.341 164.174 120.383C163.289 121.816 162.352 123.204 161.361 124.533C157.879 122.693 154.334 120.958 150.736 119.327ZM140.65 133.638C144.068 130 147.388 125.362 150.387 119.96C153.952 121.575 157.464 123.292 160.917 125.114C157.002 130.235 152.368 134.488 147.4 137.492C145.203 136.119 142.952 134.833 140.65 133.638ZM144.863 138.91C139.374 141.698 133.794 142.903 128.431 142.51C127.999 142.429 127.566 142.342 127.133 142.248C131.3 141.518 135.785 138.665 140.131 134.183C142.37 135.338 144.56 136.58 146.698 137.904C146.09 138.256 145.48 138.596 144.863 138.91ZM133.328 143.162C137.258 142.762 141.25 141.555 145.191 139.552C145.931 139.176 146.664 138.764 147.394 138.334C148.781 139.212 150.143 140.126 151.485 141.074C145.711 142.912 139.552 143.661 133.328 143.162ZM100.046 98.5845L100.065 98.5264C99.8749 100.428 99.7773 102.312 99.7686 104.166C96.5687 103.675 93.3615 103.266 90.1506 102.938C89.7603 100.368 89.5798 97.7518 89.6233 95.1169L100.046 98.5845ZM106.045 60.2268C108.586 61.8931 111.17 63.4841 113.795 64.9992C113.183 65.7457 112.585 66.5148 112.002 67.3049C111.089 66.8131 110.143 66.3907 109.239 66.0899C105.668 64.9019 102.262 65.0952 99.4421 67.1629C101.415 64.6142 103.63 62.2932 106.045 60.2268ZM121.722 51.3084C123.12 52.3079 124.544 53.2691 125.992 54.1917C121.772 56.787 117.791 60.2504 114.262 64.4377C111.674 62.9474 109.126 61.379 106.622 59.7413C111.098 56.0301 116.225 53.1722 121.722 51.3084ZM162.129 56.0134C167.482 59.3558 172.019 63.6814 175.576 68.6633C173.931 68.6177 172.285 68.5328 170.646 68.4048C168.585 63.4996 165.706 59.2741 162.129 56.0134ZM162.357 67.3787C161.563 61.1866 159.68 56.217 156.782 53.1321C157.155 53.3045 157.523 53.4791 157.89 53.6585C163.066 56.9653 167.144 62.0664 169.842 68.3328C167.336 68.1123 164.84 67.7961 162.357 67.3787ZM162.345 82.4931C162.904 77.2854 162.93 72.4272 162.447 68.1256C165.002 68.5473 167.57 68.8658 170.149 69.082C172.008 73.6459 173.158 78.7932 173.484 84.292C169.749 83.8254 166.032 83.2233 162.345 82.4931ZM131.874 129.625C133.202 127.018 134.38 124.477 135.245 122.544C142.035 124.504 147.552 123.364 149.641 119.622C149.674 119.637 149.708 119.653 149.741 119.668C146.742 125.08 143.429 129.714 140.028 133.318C137.374 131.966 134.654 130.733 131.874 129.625ZM119.333 139.854C115.657 137.186 113.31 131.84 112.393 124.839C115.261 125.342 118.113 125.977 120.936 126.741C119.898 132.981 119.631 137.854 120.452 140.287C120.076 140.148 119.705 140.003 119.333 139.854ZM112.009 107.193C111.175 113.313 111.053 119.016 111.611 123.977C109.056 123.555 106.486 123.236 103.907 123.02C101.734 117.665 100.551 111.526 100.49 105.01C104.345 105.619 108.187 106.348 112.009 107.193ZM133.408 58.4641C130.443 61.6186 127.553 65.5239 124.882 70.027C121.495 68.4054 118.162 66.6639 114.894 64.8002C118.436 60.6156 122.434 57.1684 126.665 54.6145C128.86 55.9868 131.107 57.2703 133.408 58.4641ZM142.529 61.8378C139.812 60.7579 137.148 59.558 134.55 58.242C139.479 53.1865 144.561 50.3119 149.102 50.3781C149.49 50.48 149.873 50.5878 150.259 50.7C148.143 52.158 145.437 56.2177 142.529 61.8378ZM150.067 79.5464C151.286 74.7841 152.31 70.181 153.024 66.0824C155.909 66.8594 158.824 67.5031 161.757 68.009C162.246 72.2821 162.218 77.1376 161.652 82.3539C157.756 81.5649 153.892 80.6291 150.067 79.5464ZM154.303 93.0555L152.613 93.3483C151.382 91.883 149.626 90.7627 147.389 90.0183C147.314 89.9935 147.244 89.979 147.171 89.9547C148.139 86.7258 149.056 83.4548 149.888 80.2452C153.744 81.3344 157.641 82.2778 161.569 83.0721C161.228 85.9861 160.721 89.0082 160.042 92.0985C157.847 92.4421 156.121 92.7407 154.303 93.0555ZM125.23 110.6C126.655 111.023 128.075 111.458 129.49 111.912C129.557 112.175 129.641 112.432 129.753 112.679C127.777 112.81 126.402 113.626 125.967 114.935C125.05 117.691 127.715 120.066 134.114 122.195C134.258 122.243 134.402 122.287 134.546 122.331C133.357 124.994 132.243 127.332 131.206 129.365C129.658 128.762 128.093 128.192 126.511 127.665C124.924 127.137 123.327 126.656 121.722 126.21C122.482 121.79 123.648 116.527 125.23 110.6ZM124.564 110.406C123.068 116.044 121.86 121.389 121.056 126.026C118.164 125.245 115.241 124.602 112.301 124.094C111.736 119.17 111.859 113.474 112.702 107.345C116.682 108.239 120.638 109.261 124.564 110.406ZM118.449 101.056L117.355 104.343L125.478 107.046C125.228 107.938 124.985 108.827 124.749 109.709C120.796 108.555 116.811 107.529 112.803 106.629C113.007 105.232 113.248 103.816 113.525 102.381C115.03 102.121 116.675 101.617 118.449 101.056ZM136.215 75.6958C134.981 78.7002 133.762 81.844 132.583 85.0545L121.005 85.2215L122.751 88.1254L118.676 100.373C117.861 100.387 117.033 100.302 116.348 100.074C114.206 99.3612 114.375 97.8525 115.568 94.2681L119.411 82.7158C121.141 78.4784 123.08 74.5345 125.155 70.957C128.782 72.6761 132.47 74.258 136.215 75.6958ZM136.489 75.0288C132.776 73.6034 129.117 72.0365 125.52 70.3325C128.192 65.817 131.078 61.9123 134.03 58.784C136.689 60.1383 139.414 61.3732 142.198 62.4822C140.337 66.1384 138.4 70.409 136.489 75.0288ZM143.22 77.4438C141.177 76.7641 139.149 76.0376 137.136 75.2745C139.124 70.4492 141.053 66.2383 142.841 62.7338C144.393 63.3379 145.961 63.9098 147.547 64.4375C149.13 64.9641 150.723 65.4439 152.322 65.8882C151.663 69.7361 150.691 74.251 149.382 79.349C147.316 78.7549 145.261 78.123 143.22 77.4438ZM134.597 95.2898C133.716 97.9382 134.026 100.581 135.469 102.752C132.229 104.424 130.503 106.163 129.71 108.547C129.406 109.459 129.293 110.314 129.357 111.111C128.049 110.694 126.733 110.294 125.416 109.904C125.65 109.039 125.894 108.16 126.144 107.268L128.066 107.907L128.293 107.223L126.341 106.573C126.865 104.727 127.427 102.826 128.026 100.874L132.711 86.7947C134.104 82.9112 135.496 79.2838 136.862 75.9416C138.889 76.7111 140.933 77.443 142.992 78.1281C145.048 78.8122 147.119 79.4494 149.202 80.0473C148.412 83.0864 147.505 86.3267 146.475 89.752C140.924 88.276 136.216 90.4239 134.597 95.2898ZM143.747 120.992C143.253 122.477 140.324 122.795 137.081 121.715C132.582 120.219 130.173 117.316 130.259 113.516C131.188 114.8 132.806 115.833 135.074 116.588L139.701 118.127C142.814 119.163 144.062 120.046 143.747 120.992ZM147.247 105.471C146.876 106.585 146.116 107.04 145.162 106.723C143.733 106.247 142.673 103.824 141.828 99.0972C141.134 95.2006 141.035 92.9487 141.496 91.5656C141.839 90.5343 142.712 90.0253 143.622 90.3282C144.996 90.7853 145.95 92.9903 146.915 97.9395C147.606 101.52 147.719 104.052 147.247 105.471ZM154.724 52.2485C158.4 54.9162 160.747 60.2628 161.665 67.2631C158.803 66.761 155.961 66.1293 153.145 65.3679C154.177 59.2151 154.473 54.2871 153.63 51.8233C153.996 51.9596 154.361 52.1024 154.724 52.2485ZM151.943 51.2229C152.209 51.3113 152.469 51.4051 152.732 51.4962C153.68 53.1739 153.64 57.9304 152.445 65.1743C150.88 64.7397 149.322 64.2679 147.775 63.7532C146.224 63.2373 144.689 62.68 143.173 62.0894C146.508 55.6561 149.336 51.7427 151.135 50.9647C151.405 51.0509 151.675 51.1334 151.943 51.2229ZM126.68 53.7773C125.288 52.8983 123.919 51.9801 122.573 51.0285C128.386 49.1767 134.59 48.4303 140.857 48.9505C136.043 49.4282 131.23 51.0982 126.68 53.7773ZM145.653 49.598C146.077 49.6762 146.502 49.762 146.925 49.8527C142.756 50.5842 138.272 53.4376 133.927 57.9198C131.69 56.7671 129.503 55.5266 127.365 54.2022C133.229 50.8223 139.514 49.1526 145.653 49.598ZM103.718 84.9675C104.495 82.6322 105.391 80.3831 106.389 78.2255L108.662 78.9817L108.889 78.299L106.699 77.5703C107.606 75.6709 108.591 73.8458 109.649 72.1041L111.186 77.405L111.228 77.4191L115.154 69.4811C114.433 68.829 113.561 68.2108 112.633 67.662C113.216 66.8751 113.814 66.1082 114.427 65.3655C117.728 67.2507 121.094 69.0105 124.517 70.6531C122.688 73.7981 120.968 77.2214 119.401 80.8767L107.738 81.0441L109.484 83.9481L106.431 93.1247C104.742 98.202 105.673 100.978 109.529 102.261C110.511 102.588 111.597 102.627 112.777 102.489C112.522 103.834 112.297 105.165 112.109 106.475C108.253 105.626 104.376 104.892 100.487 104.279C100.507 98.0531 101.545 91.499 103.718 84.9675ZM103.363 76.4604L105.351 70.4858C106.26 67.7534 106.856 66.3887 107.485 66.3595C108.108 66.3319 108.751 68.9317 109.379 71.1699C108.161 73.1256 107.033 75.1863 106.009 77.3406L103.363 76.4604ZM105.699 77.9958C104.702 80.154 103.807 82.4053 103.031 84.739C101.568 89.1352 100.617 93.542 100.136 97.8544L96.6328 96.689L103.136 77.1431L105.699 77.9958ZM111.876 136.057C106.546 132.719 102.026 128.404 98.481 123.439C100.129 123.484 101.776 123.569 103.417 123.699C105.454 128.57 108.308 132.791 111.876 136.057ZM104.221 123.77C106.725 123.99 109.219 124.307 111.701 124.724C112.494 130.916 114.375 135.887 117.276 138.969C116.882 138.789 116.49 138.604 116.104 138.412C110.922 135.091 106.89 129.989 104.221 123.77ZM122.114 140.88C121.845 140.79 121.58 140.695 121.312 140.6C120.338 138.901 120.418 134.074 121.601 126.924C123.17 127.36 124.732 127.834 126.283 128.349C127.832 128.865 129.362 129.42 130.875 130.01C127.16 137.19 124.472 140.429 122.888 141.127C122.63 141.044 122.372 140.965 122.114 140.88ZM123.819 141.407C126.2 139.776 129.094 134.994 131.541 130.269C134.255 131.349 136.913 132.546 139.507 133.861C134.579 138.916 129.496 141.791 124.955 141.724C124.575 141.623 124.198 141.517 123.819 141.407ZM157.109 102.731C155.136 108.659 152.742 114.152 150.088 119.034C150.045 119.014 150.001 118.994 149.959 118.975C150.027 118.813 150.091 118.648 150.148 118.477C151.352 114.859 149.386 112.253 144.14 110.507L139.214 108.868C137.347 108.247 136.175 107.362 135.726 106.24C135.394 105.405 135.478 104.476 135.975 103.474C137.328 105.134 139.247 106.411 141.538 107.173C147.278 109.083 152.28 106.918 153.987 101.788C154.864 99.1522 154.665 96.5925 153.434 94.5051C155.071 95.6199 156.963 97.4859 158.283 98.9686C157.918 100.217 157.528 101.472 157.109 102.731ZM168.745 106.556C168.021 108.733 166.982 110.282 165.272 111.42C163.581 107.919 162.931 103.722 164.11 100.179C164.636 98.5994 165.589 97.8752 166.704 98.2461C168.546 98.859 169.98 102.844 168.745 106.556ZM171.185 98.0771C165.651 96.2358 160.728 98.3389 157.946 102.497C160.13 95.8365 161.557 89.2971 162.264 83.2119C165.989 83.9475 169.743 84.5567 173.518 85.0238C173.712 89.258 173.434 93.6861 172.619 98.2119C172.594 98.3539 172.564 98.4965 172.539 98.6385C172.116 98.4263 171.666 98.2372 171.185 98.0771ZM90.269 103.674C93.4421 104.002 96.6094 104.407 99.7687 104.895C99.8193 111.412 100.978 117.562 103.114 122.955C101.403 122.825 99.6861 122.743 97.9675 122.705C94.0641 117.017 91.419 110.515 90.269 103.674ZM152.407 49.8301C140.656 45.9205 128.457 46.7231 117.879 51.1985C104.942 29.3075 76.9457 20.7889 53.8623 32.2927C29.7748 44.2942 20.0189 73.617 32.1145 97.6587C38.1618 109.678 48.5446 118.138 60.4266 122.091C71.4093 125.745 83.6728 125.545 94.9784 120.754C100.776 130.554 110.003 138.397 121.651 142.272C147.235 150.785 174.948 136.974 183.428 111.488C191.907 86.0026 177.992 58.3424 152.407 49.8301Z"
                fill="#0A0A0A"
              />
              <path
                d="M70.8951 52.3891C73.045 53.1044 75.8155 50.597 77.0832 46.7866C78.3504 42.9778 77.6344 39.3104 75.4845 38.5951C73.3346 37.8799 70.5641 40.3872 69.2969 44.196C68.0292 48.0064 68.7452 51.6738 70.8951 52.3891Z"
                fill="#0A0A0A"
              />
              <path
                d="M93.901 60.0433C96.0509 60.7586 98.8213 58.2512 100.089 54.4408C101.356 50.632 100.64 46.9647 98.4903 46.2494C96.3404 45.5341 93.57 48.0415 92.3028 51.8503C91.035 55.6607 91.7511 59.3281 93.901 60.0433Z"
                fill="#0A0A0A"
              />
            </svg>
          </div>
        </div>
        <div
          tw={`flex flex-col grow w-full grow pt-[94px] pr-16"
            }`}
          style={{
            gap: longSchedule ? 22 : 37,
          }}
        >
          {todaysSchedule.map((item, index) => (
            <div tw="flex flex-col" key={item.date}>
              <div
                tw={`font-bold -mb-1`}
                style={{
                  fontFamily: '"VisueltMedium"',
                  lineHeight: "88%",
                  fontSize: responsiveFontSize,
                  letterSpacing: "-0.03em",
                }}
              >
                {dayjs(item.date.slice(0, -1))
                  .add(cetAdjustment, "minutes")
                  .format("HH:mm")}
              </div>
              <div
                tw={`font-bold}`}
                style={{
                  fontFamily: '"VisueltMedium"',
                  lineHeight: "88%",
                  fontSize: responsiveFontSize,
                  letterSpacing: "-0.03em",
                }}
              >
                {item.title}
              </div>
            </div>
          ))}
          <div tw="flex flex-col">
            <div
              tw={`font-bold -mb-1`}
              style={{
                fontFamily: '"VisueltMedium"',
                lineHeight: "88%",
                fontSize: responsiveFontSize,
                letterSpacing: "-0.03em",
              }}
            >
              {dayjs(
                todaysSchedule[todaysSchedule.length - 1].dateEnd.slice(0, -1)
              )
                .add(cetAdjustment, "minutes")
                .format("HH:mm")}
            </div>
            <div
              tw={`font-bold`}
              style={{
                fontFamily: '"VisueltMedium"',
                lineHeight: "88%",
                fontSize: responsiveFontSize,
                letterSpacing: "-0.04em",
              }}
            >
              Repeats Playlist
            </div>
          </div>
        </div>
        <div tw={`flex justify-center`}>
          <div
            tw={`flex text-[30px] pb-[59px]`}
            style={{ fontFamily: '"fontArizona"', lineHeight: "90%" }}
          >
            refugeworldwide.com
          </div>
        </div>
      </div>
    ),
    {
      width: 1080,
      height: 1920,
      headers: {
        "Cache-Control": "no-store",
      },
      fonts: [
        {
          name: "Visuelt",
          data: fontLight,
          style: "normal",
        },
        {
          name: "VisueltMedium",
          data: fontMedium,
          style: "normal",
        },
        {
          name: "fontArizona",
          data: fontArizona,
          style: "normal",
        },
      ],
      // debug: true,
    }
  );
}

export default handle;
